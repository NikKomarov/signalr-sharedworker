@page
<div class="container">
    <div class="row">&nbsp;</div>
    <div class="row">
        <div class="col-6">&nbsp;</div>
        <div class="col-6">
            User..........<input type="text" id="userInput" />
            <br />
            Message...<input type="text" id="messageInput" />
            <input type="button" id="sendButton" value="Send Message" />
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <hr />
        </div>
    </div>
    <div class="row">
        <div class="col-6">&nbsp;</div>
        <div class="col-6">
            <ul id="messagesList"></ul>
        </div>
    </div>
</div>

@*Используйте эти 2 строчки, чтобы использовать просто обычный js. Откройте n вкладок
, отправьте сообщение с любой из страниц, откроется n окон
<script src="~/lib/@@aspnet/signalr/dist/browser/signalr.js"></script>
<script src="~/js/chat.js"></script>*@

@*пример работы web workers
<script src="~/lib/@@aspnet/signalr/dist/webworker/signalr.js"></script>
<script>
    if (window.Worker) {
        var worker = new Worker('/js/worker.js')
        worker.postMessage(window.location.origin);
        let messageText = document.getElementById('messageInput');
        let broadcastButton = document.getElementById('sendButton');
        let userText = document.getElementById('userInput');

        broadcastButton.addEventListener('click', function (event) {
            worker.postMessage({
                user: userText.value,
                message: messageText.value
            });
            event.preventDefault();
        });

        worker.onmessage = function (e) {
            console.log(e);
            //if (e.data === 'connected') {
            //    //broadcastButton.disabled = false;
            //    //addLine('Connection started.');
            //} else {
            //    //addLine(e.data);
            //}
        };
    } else {
        addLine('Web workers are not supported by this browser!')
    }
</script>*@

@*пример работы shared worker*@

<script src="~/lib/@@aspnet/signalr/dist/webworker/signalr.js"></script>
<script>
    if (window.SharedWorker) {
        var worker = new SharedWorker('/js/sharedworker.js');
        worker.port.postMessage({
            type: 'init',
            location: window.location.origin
        });

        let messageText = document.getElementById('messageInput');
        let broadcastButton = document.getElementById('sendButton');
        let userText = document.getElementById('userInput');

        broadcastButton.addEventListener('click', function (event) {
            worker.port.postMessage({
                type: 'message',
                user: userText.value,
                message: messageText.value
            });
            event.preventDefault();
        });

        worker.port.onmessage = function (e) {
            console.log(e);
            if (e.data.type == 'openUrl') {
                window.open(e.data.url, '_blank');
            }
           
        };

        addEventListener('beforeunload', function () {
            worker.port.postMessage({
                type: 'close'
            });
        });
    } else {
        console.log('Web workers are not supported by this browser!')
    }
</script>